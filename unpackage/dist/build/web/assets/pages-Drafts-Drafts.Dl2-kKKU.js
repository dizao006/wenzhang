import{_ as a,p as t,r as s,s as e,ar as l,c as r,d as c,j as d,o as i,e as o,h as f,f as n,g as u,t as _,U as m,F as p,i as I,B as v,z as k}from"./index-VArvefSN.js";import{a as h}from"./http.BhNkKofT.js";const C=a({__name:"Drafts",setup(a){const C=t(),b=s([]),y=async()=>{try{const t=C.state.userInfo._id,s=await(a={userId:t},h({name:"getDrafts",data:a}));b.value=s}catch(t){console.error("获取草稿列表失败:",t)}var a},x=a=>{I({url:`/pages/articPush/articPush?articleId=${a}`})},D=async a=>{try{b.value=b.value.filter((t=>t.articleId!==a)),await(t={articleId:a},h({name:"removeDrafts",data:t})),await y(),k({title:"草稿已删除",icon:"success"})}catch(s){console.error("删除草稿失败:",s),k({title:"删除失败",icon:"error"})}var t};return e((()=>{y()})),l((()=>{y()})),(a,t)=>{const s=d,e=v;return i(),r(s,{class:"draft-box"},{default:c((()=>[o(s,{class:"title"},{default:c((()=>[f("草稿箱")])),_:1}),o(s,{class:"draft-list"},{default:c((()=>[(i(!0),n(p,null,u(b.value,(a=>(i(),r(s,{key:a.articleId,class:"draft-card"},{default:c((()=>[o(s,{class:"draft-content",onClick:t=>x(a.articleId)},{default:c((()=>[o(s,{class:"draft-title"},{default:c((()=>[f(_(a.title),1)])),_:2},1024),o(s,{class:"draft-abstract"},{default:c((()=>[f(_(a.abstractText),1)])),_:2},1024),o(s,{class:"draft-time"},{default:c((()=>[f(_(a.create_time),1)])),_:2},1024)])),_:2},1032,["onClick"]),o(s,{class:"draft-actions"},{default:c((()=>[o(e,{class:"edit-btn",onClick:m((t=>x(a.articleId)),["stop"])},{default:c((()=>[f("编辑")])),_:2},1032,["onClick"]),o(e,{class:"delete-btn",onClick:m((t=>D(a.articleId)),["stop"])},{default:c((()=>[f("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-5626a7ef"]]);export{C as default};
