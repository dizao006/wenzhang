import{N as a}from"./NavBar.g0XsGZiw.js";import{r as e,w as t,a as i,o as s,c as n,b as l,d as c,u as o,e as r,F as d,f as u,n as v,g as m,t as p,h as I,i as x,S as f,j as g,k as L,l as _,m as h,p as b}from"./index-DwdDHTgs.js";import{_ as j,r as w,o as y}from"./uni-app.es.DtYEfKEf.js";import{_ as k}from"./uni-icons.DL8JbnSX.js";import{u as C}from"./isLogin.D9YIoZAy.js";import{L as B}from"./ListItem.v-rBIgr1.js";import{g as N,a as S}from"./home.DDCdm6RB.js";import"./listCard.D60NJvx5.js";import"./love.DrTljd9n.js";import"./uni-load-more.CK7k2JIr.js";const A=j({__name:"TabBar",props:["activeIndex","labeList"],emits:["changeIndex"],setup(a,{emit:g}){let L=a,_=g,h=e("item0");const{checkLogin:b}=C();async function j(){await b(),I({url:"/pages/abelAdmin/abelAdmin"})}return t((()=>L.activeIndex),(a=>{h.value=`item${a}`})),(e,t)=>{const I=x,g=f,L=w(i("uni-icons"),k);return s(),n(I,{class:"tabBar"},{default:l((()=>[c(g,{"scroll-x":"true",class:"tabScroll","scroll-with-animation":!0,"scroll-into-view":o(h)},{default:l((()=>[c(I,{class:"box"},{default:l((()=>[(s(!0),r(d,null,u(a.labeList,((e,t)=>(s(),n(I,{onClick:a=>function(a){_("changeIndex",a)}(t),class:v([{active:a.activeIndex==t},"tab-item"]),key:e._id,id:`item${t}`},{default:l((()=>[m(p(e.name),1)])),_:2},1032,["onClick","class","id"])))),128))])),_:1})])),_:1},8,["scroll-into-view"]),c(I,{class:"icons"},{default:l((()=>[c(L,{type:"gear",size:"26",color:"#666",onClick:j})])),_:1})])),_:1})}}},[["__scopeId","data-v-133d6240"]]),M=j({__name:"ArticleList",props:["artList","activeIndex"],emits:["changeIndex"],setup(a,{emit:v}){let m=a,p=v,I=e({}),x=e({}),f=e();e(1);let h=e(6);function b(a){const e=a.detail.current;p("changeIndex",e)}async function j(a){x.value[m.activeIndex]||(x.value[m.activeIndex]={page:1,loading:"loading,",total:0});let{articleList:e,total:t}=await N({classify:a.name,page:x.value[m.activeIndex].page,pageSize:h.value}),i=I.value[m.activeIndex]||[];JSON.stringify(e)!==JSON.stringify(i)&&i.push(...e),I.value[m.activeIndex]=i,x.value[m.activeIndex].total=t}function y(){if(x.value[m.activeIndex].total===I.value[m.activeIndex].length)return x.value[m.activeIndex]={...x.value[m.activeIndex],loading:"noMore"},void g();x.value[m.activeIndex].page++,j(f.value)}return t([()=>m.artList,()=>m.activeIndex],(a=>{f.value=a[0][a[1]],j(f.value)}),{immediate:!0}),(a,e)=>{const t=w(i("ListItem"),B),v=L,p=_;return s(),n(p,{class:"swiper-container",current:o(m).activeIndex,onChange:b},{default:l((()=>[(s(!0),r(d,null,u(o(m).artList,(a=>(s(),n(v,{class:"swiper-item",key:a._id},{default:l((()=>[c(t,{loadData:o(x)[o(m).activeIndex],onLoadMore:y,articleList:o(I)[o(m).activeIndex],isLoadMore:!1},null,8,["loadData","articleList"])])),_:2},1024)))),128))])),_:1},8,["current"])}}},[["__scopeId","data-v-36cd0cdc"]]),z=j({__name:"index",setup(r){let d=e(0);const u=h(),v=e();function m(a){d.value=a}const p=e(),{checkLogin:I}=C();return y((async()=>{await I()})),b((async()=>{p.value=await S(),p.value=[{name:"全部"},...p.value],u.commit("setlabelList",p.value)})),t((()=>u.state.labelListItem),((a,e)=>{v.value=[{name:"全部"},...a]}),{immediate:!0,deep:!0}),(e,t)=>{const r=w(i("NavBar"),a),u=w(i("TabBar"),A),I=w(i("ArticleList"),M),f=x;return s(),n(f,{class:"container"},{default:l((()=>[c(r),c(u,{labeList:v.value.length>1?v.value:p.value,activeIndex:o(d),onChangeIndex:m},null,8,["labeList","activeIndex"]),c(I,{artList:v.value.length>1?v.value:p.value,activeIndex:o(d),class:"list-container",onChangeIndex:m},null,8,["artList","activeIndex"])])),_:1})}}},[["__scopeId","data-v-0b00c12e"]]);export{z as default};
