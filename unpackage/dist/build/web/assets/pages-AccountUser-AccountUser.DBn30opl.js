import{_ as e,p as t,r as a,a as l,b as s,c as o,d as u,j as n,a6 as c,o as i,e as r,u as d,h as p,t as f,z as _,i as m,v,A as b,B as k,I as C}from"./index-VArvefSN.js";import{_ as y,a as w}from"./uni-list.B51mJEsd.js";import{a as I}from"./http.BhNkKofT.js";import"./uni-icons.BPusHlUG.js";const g=e=>I({name:"addIntegrl_count",data:e}),h=e({__name:"AccountUser",setup(e){const I=t(),h=a(null),V=a(null),j=a(0),U=a(0);function F(){h.value.open(),document.body.style.overflow="hidden"}function x(){h.value.close(),document.body.style.overflow="auto",j.value=0}function A(){V.value.open(),document.body.style.overflow="hidden"}function P(){V.value.close(),document.body.style.overflow="auto",U.value=0}function z(e){j.value=e}function B(e){U.value=e}async function D(){if(j.value<=0)return void _({title:"请输入有效金额",icon:"none"});console.log("充值金额:",{id:I.state.userInfo._id,count:j.value});let e=await g({id:I.state.userInfo._id,count:j.value});0==e.code&&_({title:e.msg,icon:"success"}),I.commit("updateUserInfo",e.result),x()}async function J(){if(U.value<=0)return void _({title:"请输入有效金额",icon:"none"});const e=parseFloat(I.state.userInfo.integral_count);if(U.value>e)return void _({title:"余额不足，无法提现",icon:"none"});let t=await g({id:I.state.userInfo._id,count:-U.value});0==t.code&&_({title:t.msg,icon:"success"}),I.commit("updateUserInfo",t.result),P()}function q(){m({url:"/pages/gift/gift"})}return(e,t)=>{const a=v,_=b,m=n,g=l(s("uni-list-item"),y),E=l(s("uni-list"),w),G=k,H=C,K=l(s("uni-popup"),c);return i(),o(m,{class:"account-page"},{default:u((()=>[r(a,{class:"header-bg",src:d(I).state.userInfo.avatar,mode:"aspectFill"},null,8,["src"]),r(m,{class:"user-info"},{default:u((()=>[r(a,{class:"avatar",src:d(I).state.userInfo.avatar,mode:"aspectFill"},null,8,["src"]),r(_,{class:"username"},{default:u((()=>[p(f(d(I).state.userInfo.author_name),1)])),_:1})])),_:1}),r(m,{class:"balance-card"},{default:u((()=>[r(a,{class:"card-bg",src:d(I).state.userInfo.avatar,mode:"aspectFill"},null,8,["src"]),r(m,{class:"card-content"},{default:u((()=>[r(_,{class:"balance-label"},{default:u((()=>[p("当前积分")])),_:1}),r(_,{class:"balance-amount"},{default:u((()=>[p(f(d(I).state.userInfo.integral_count),1)])),_:1})])),_:1})])),_:1}),r(m,{class:"function-list"},{default:u((()=>[r(E,null,{default:u((()=>[r(m,{onClick:F},{default:u((()=>[r(g,{title:"充值","show-arrow":""})])),_:1}),r(m,{class:"",onClick:A},{default:u((()=>[r(g,{title:"提现","show-arrow":""})])),_:1}),r(m,{onClick:q},{default:u((()=>[r(g,{title:"消费","show-arrow":""})])),_:1})])),_:1})])),_:1}),r(K,{ref_key:"rechargePopup",ref:h,type:"bottom"},{default:u((()=>[r(m,{class:"popup-content"},{default:u((()=>[r(_,{class:"popup-title"},{default:u((()=>[p("充值")])),_:1}),r(m,{class:"preset-amounts"},{default:u((()=>[r(G,{class:"preset-button",onClick:t[0]||(t[0]=e=>z(1))},{default:u((()=>[p("1 元")])),_:1}),r(G,{class:"preset-button",onClick:t[1]||(t[1]=e=>z(5))},{default:u((()=>[p("5 元")])),_:1}),r(G,{class:"preset-button",onClick:t[2]||(t[2]=e=>z(10))},{default:u((()=>[p("10 元")])),_:1}),r(G,{class:"preset-button",onClick:t[3]||(t[3]=e=>z(50))},{default:u((()=>[p("50 元")])),_:1}),r(G,{class:"preset-button",onClick:t[4]||(t[4]=e=>z(100))},{default:u((()=>[p("100 元")])),_:1})])),_:1}),r(H,{class:"popup-input",type:"number",modelValue:j.value,"onUpdate:modelValue":t[5]||(t[5]=e=>j.value=e),placeholder:"请输入充值金额"},null,8,["modelValue"]),r(G,{class:"popup-button confirm",onClick:D},{default:u((()=>[p("确认充值")])),_:1}),r(G,{class:"popup-button cancel",onClick:x},{default:u((()=>[p("取消")])),_:1})])),_:1})])),_:1},512),r(K,{ref_key:"withdrawPopup",ref:V,type:"bottom"},{default:u((()=>[r(m,{class:"popup-content"},{default:u((()=>[r(_,{class:"popup-title"},{default:u((()=>[p("提现")])),_:1}),r(m,{class:"preset-amounts"},{default:u((()=>[r(G,{class:"preset-button",onClick:t[6]||(t[6]=e=>B(1))},{default:u((()=>[p("1 元")])),_:1}),r(G,{class:"preset-button",onClick:t[7]||(t[7]=e=>B(5))},{default:u((()=>[p("5 元")])),_:1}),r(G,{class:"preset-button",onClick:t[8]||(t[8]=e=>B(10))},{default:u((()=>[p("10 元")])),_:1}),r(G,{class:"preset-button",onClick:t[9]||(t[9]=e=>B(50))},{default:u((()=>[p("50 元")])),_:1}),r(G,{class:"preset-button",onClick:t[10]||(t[10]=e=>B(100))},{default:u((()=>[p("100 元")])),_:1})])),_:1}),r(H,{class:"popup-input",type:"number",modelValue:U.value,"onUpdate:modelValue":t[11]||(t[11]=e=>U.value=e),placeholder:"请输入提现金额"},null,8,["modelValue"]),r(G,{class:"popup-button confirm",onClick:J},{default:u((()=>[p("确认提现")])),_:1}),r(G,{class:"popup-button cancel",onClick:P},{default:u((()=>[p("取消")])),_:1})])),_:1})])),_:1},512)])),_:1})}}},[["__scopeId","data-v-dca52744"]]);export{h as default};
