var t=Object.defineProperty,e=(e,s,n)=>(((e,s,n)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n})(e,"symbol"!=typeof s?s+"":s,n),n);import{N as s,O as n,P as i,h as r,D as l,Q as a,o,c,b as h,e as u,F as p,f as d,C as g,s as f,n as m,R as k,g as x,t as b,d as y,q as w,y as v,i as _,T as $,U as T,V as z,W as R,X as I,Z as S,J as A,m as L,r as N,B as O,a as C,_ as E,x as j,a0 as q,z as P}from"./index-DwdDHTgs.js";import{_ as Z,a as B,o as D,r as Q}from"./uni-app.es.DtYEfKEf.js";import{_ as M}from"./uni-icons.DL8JbnSX.js";import{g as F,_ as U,u as V,c as H}from"./getCommentData.f_QQ-CpS.js";import{_ as X}from"./love.DrTljd9n.js";import{u as J}from"./isLogin.D9YIoZAy.js";var G={abbr:!0,b:!0,big:!0,code:!0,del:!0,em:!0,i:!0,ins:!0,label:!0,q:!0,small:!0,span:!0,strong:!0,sub:!0,sup:!0};const W={isInline:function(t,e){return G[t]||-1!==(e||"").indexOf("display:inline")}},K=t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("handler"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.handler=W}})},Y={name:"node",options:{},data:()=>({ctrl:{}}),props:{name:String,attrs:{type:Object,default:()=>({})},childs:Array,opts:Array},components:{},mounted(){if(this.$nextTick((()=>{for(this.root=this.$parent;"uv-parse"!==this.root.$options.name;this.root=this.root.$parent);})),this.opts[0]){let t;for(t=this.childs.length;t--&&"img"!==this.childs[t].name;);-1!==t&&(this.observer=s(this).relativeToViewport({top:500,bottom:500}),this.observer.observe("._img",(t=>{t.intersectionRatio&&(this.$set(this.ctrl,"load",1),this.observer.disconnect())})))}},beforeDestroy(){this.observer&&this.observer.disconnect()},methods:{play(t){if(this.root.$emit("play"),this.root.pauseVideo){let e=!1;const s=t.target.id;for(let t=this.root._videos.length;t--;)this.root._videos[t].id===s?e=!0:this.root._videos[t].pause();if(!e){const t=n(s,this);t.id=s,this.root.playbackRate&&t.playbackRate(this.root.playbackRate),this.root._videos.push(t)}}},imgTap(t){const e=this.childs[t.currentTarget.dataset.i];e.a?this.linkTap(e.a):e.attrs.ignore||(e.attrs.src=e.attrs.src||e.attrs["data-src"],this.root.$emit("imgtap",e.attrs),this.root.previewImg&&i({current:parseInt(e.attrs.i),urls:this.root.imgList}))},imgLongTap(t){},imgLoad(t){const e=t.currentTarget.dataset.i;(this.opts[1]&&!this.ctrl[e]||-1===this.ctrl[e])&&this.$set(this.ctrl,e,1),this.checkReady()},checkReady(){this.root&&!this.root.lazyLoad&&(this.root._unloadimgs-=1,this.root._unloadimgs||setTimeout((()=>{this.root.getRect().then((t=>{this.root.$emit("ready",t)})).catch((()=>{this.root.$emit("ready",{})}))}),350))},linkTap(t){const e=t.currentTarget?this.childs[t.currentTarget.dataset.i]:{},s=e.attrs||t,n=s.href;this.root.$emit("linktap",Object.assign({innerText:this.root.getText(e.children||[])},s)),n&&("#"===n[0]?this.root.navigateTo(n.substring(1)).catch((()=>{})):n.split("?")[0].includes("://")?this.root.copyLink&&window.open(n):r({url:n,fail(){l({url:n,fail(){}})}}))},mediaError(t){const e=t.currentTarget.dataset.i,s=this.childs[e];if("video"===s.name||"audio"===s.name){let t=(this.ctrl[e]||0)+1;if(t>s.src.length&&(t=0),t<s.src.length)return void this.$set(this.ctrl,e,t)}else if("img"===s.name){if(this.opts[0]&&!this.ctrl.load)return;this.opts[2]&&this.$set(this.ctrl,e,-1),this.checkReady()}this.root&&this.root.$emit("error",{source:s.name,attrs:s.attrs})}}};K(Y);const tt=Z(Y,[["render",function(t,e,s,n,i,r){const l=w,z=v,R=a("node",!0),I=_,S=$,A=T;return o(),c(I,{id:s.attrs.id,class:m("_block _"+s.name+" "+s.attrs.class),style:g(s.attrs.style)},{default:h((()=>[(o(!0),u(p,null,d(s.childs,((n,a)=>(o(),u(p,{key:a},["img"===n.name&&!n.t&&(s.opts[1]&&!i.ctrl[a]||i.ctrl[a]<0)?(o(),c(l,{key:0,class:"_img",style:g(n.attrs.style),src:i.ctrl[a]<0?s.opts[2]:s.opts[1],mode:"widthFix"},null,8,["style","src"])):f("",!0),"img"===n.name?(o(),u("img",{key:1,id:n.attrs.id,class:m("_img "+n.attrs.class),style:g((-1===i.ctrl[a]?"display:none;":"")+n.attrs.style),src:n.attrs.src||(i.ctrl.load?n.attrs["data-src"]:""),"data-i":a,onLoad:e[0]||(e[0]=(...t)=>r.imgLoad&&r.imgLoad(...t)),onError:e[1]||(e[1]=(...t)=>r.mediaError&&r.mediaError(...t)),onClick:e[2]||(e[2]=k(((...t)=>r.imgTap&&r.imgTap(...t)),["stop"])),onLongpress:e[3]||(e[3]=(...t)=>r.imgLongTap&&r.imgLongTap(...t))},null,46,["id","src","data-i"])):n.text?(o(),c(z,{key:2,decode:""},{default:h((()=>[x(b(n.text),1)])),_:2},1024)):"br"===n.name?(o(),c(z,{key:3},{default:h((()=>[x("\\n")])),_:1})):"a"===n.name?(o(),c(I,{key:4,id:n.attrs.id,class:m((n.attrs.href?"_a ":"")+n.attrs.class),"hover-class":"_hover",style:g("display:inline;"+n.attrs.style),"data-i":a,onClick:k(r.linkTap,["stop"])},{default:h((()=>[y(R,{name:"span",childs:n.children,opts:s.opts,style:{display:"inherit"}},null,8,["childs","opts"])])),_:2},1032,["id","class","style","data-i","onClick"])):"video"===n.name?(o(),c(S,{key:5,id:n.attrs.id,class:m(n.attrs.class),style:g(n.attrs.style),autoplay:n.attrs.autoplay,controls:n.attrs.controls,loop:n.attrs.loop,muted:n.attrs.muted,"object-fit":n.attrs["object-fit"],poster:n.attrs.poster,src:n.src[i.ctrl[a]||0],"data-i":a,onPlay:r.play,onError:r.mediaError},null,8,["id","class","style","autoplay","controls","loop","muted","object-fit","poster","src","data-i","onPlay","onError"])):"iframe"===n.name?(o(),u("iframe",{key:6,style:g(n.attrs.style),allowfullscreen:n.attrs.allowfullscreen,frameborder:n.attrs.frameborder,src:n.attrs.src},null,12,["allowfullscreen","frameborder","src"])):"embed"===n.name?(o(),u("embed",{key:7,style:g(n.attrs.style),src:n.attrs.src},null,12,["src"])):"table"===n.name&&n.c||"li"===n.name?(o(),c(I,{key:8,id:n.attrs.id,class:m("_"+n.name+" "+n.attrs.class),style:g(n.attrs.style)},{default:h((()=>["li"===n.name?(o(),c(R,{key:0,childs:n.children,opts:s.opts},null,8,["childs","opts"])):(o(!0),u(p,{key:1},d(n.children,((t,e)=>(o(),c(I,{key:e,class:m("_"+t.name+" "+t.attrs.class),style:g(t.attrs.style)},{default:h((()=>["td"===t.name||"th"===t.name?(o(),c(R,{key:0,childs:t.children,opts:s.opts},null,8,["childs","opts"])):(o(!0),u(p,{key:1},d(t.children,((t,e)=>(o(),u(p,{key:e},["td"===t.name||"th"===t.name?(o(),c(I,{key:0,class:m("_"+t.name+" "+t.attrs.class),style:g(t.attrs.style)},{default:h((()=>[y(R,{childs:t.children,opts:s.opts},null,8,["childs","opts"])])),_:2},1032,["class","style"])):(o(),c(I,{key:1,class:m("_"+t.name+" "+t.attrs.class),style:g(t.attrs.style)},{default:h((()=>[(o(!0),u(p,null,d(t.children,((t,e)=>(o(),c(I,{key:e,class:m("_"+t.name+" "+t.attrs.class),style:g(t.attrs.style)},{default:h((()=>[y(R,{childs:t.children,opts:s.opts},null,8,["childs","opts"])])),_:2},1032,["class","style"])))),128))])),_:2},1032,["class","style"]))],64)))),128))])),_:2},1032,["class","style"])))),128))])),_:2},1032,["id","class","style"])):n.c||t.handler.isInline(n.name,n.attrs.style)?2===n.c?(o(),c(I,{key:10,id:n.attrs.id,class:m("_block _"+n.name+" "+n.attrs.class),style:g(n.f+";"+n.attrs.style)},{default:h((()=>[(o(!0),u(p,null,d(n.children,((t,e)=>(o(),c(R,{key:e,style:g(t.f),name:t.name,attrs:t.attrs,childs:t.children,opts:s.opts},null,8,["style","name","attrs","childs","opts"])))),128))])),_:2},1032,["id","class","style"])):(o(),c(R,{key:11,style:g(n.f),name:n.name,attrs:n.attrs,childs:n.children,opts:s.opts},null,8,["style","name","attrs","childs","opts"])):(o(),c(A,{key:9,id:n.attrs.id,style:g(n.f),"user-select":s.opts[4],nodes:[n]},null,8,["id","style","user-select","nodes"]))],64)))),128))])),_:1},8,["id","class","style"])}],["__scopeId","data-v-262e072e"]]),et={trustTags:lt("a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,ruby,rt,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video"),blockTags:lt("address,article,aside,body,caption,center,cite,footer,header,html,nav,pre,section"),ignoreTags:lt("area,base,canvas,embed,frame,head,iframe,input,link,map,meta,param,rp,script,source,style,textarea,title,track,wbr"),voidTags:lt("area,base,br,col,circle,ellipse,embed,frame,hr,img,input,line,link,meta,param,path,polygon,rect,source,track,use,wbr"),entities:{lt:"<",gt:">",quot:'"',apos:"'",ensp:" ",emsp:" ",nbsp:" ",semi:";",ndash:"–",mdash:"—",middot:"·",lsquo:"‘",rsquo:"’",ldquo:"“",rdquo:"”",bull:"•",hellip:"…",larr:"←",uarr:"↑",rarr:"→",darr:"↓"},tagStyle:{address:"font-style:italic",big:"display:inline;font-size:1.2em",caption:"display:table-caption;text-align:center",center:"text-align:center",cite:"font-style:italic",dd:"margin-left:40px",mark:"background-color:yellow",pre:"font-family:monospace;white-space:pre",s:"text-decoration:line-through",small:"display:inline;font-size:0.8em",strike:"text-decoration:line-through",u:"text-decoration:underline"},svgDict:{animatetransform:"animateTransform",lineargradient:"linearGradient",viewbox:"viewBox",attributename:"attributeName",repeatcount:"repeatCount",repeatdur:"repeatDur"}},st={},{windowWidth:nt}=z(),it=lt(" ,\r,\n,\t,\f");let rt=0;function lt(t){const e=Object.create(null),s=t.split(",");for(let n=s.length;n--;)e[s[n]]=!0;return e}function at(t,e){let s=t.indexOf("&");for(;-1!==s;){const n=t.indexOf(";",s+3);let i;if(-1===n)break;"#"===t[s+1]?(i=parseInt(("x"===t[s+2]?"0":"")+t.substring(s+2,n)),isNaN(i)||(t=t.substr(0,s)+String.fromCharCode(i)+t.substr(n+1))):(i=t.substring(s+1,n),(et.entities[i]||"amp"===i&&e)&&(t=t.substr(0,s)+(et.entities[i]||"&")+t.substr(n+1))),s=t.indexOf("&",s+1)}return t}function ot(t){let e=t.length-1;for(let s=e;s>=-1;s--)(-1===s||t[s].c||!t[s].name||"div"!==t[s].name&&"p"!==t[s].name&&"h"!==t[s].name[0]||(t[s].attrs.style||"").includes("inline"))&&(e-s>=5&&t.splice(s+1,e-s,{name:"div",attrs:{},children:t.slice(s+1,e+1)}),e=s-1)}function ct(t){this.options=t||{},this.tagStyle=Object.assign({},et.tagStyle,this.options.tagStyle),this.imgList=t.imgList||[],this.imgList._unloadimgs=0,this.plugins=t.plugins||[],this.attrs=Object.create(null),this.stack=[],this.nodes=[],this.pre=(this.options.containerStyle||"").includes("white-space")&&this.options.containerStyle.includes("pre")?2:0}function ht(t){this.handler=t}et.ignoreTags.iframe=void 0,et.trustTags.iframe=!0,et.ignoreTags.embed=void 0,et.trustTags.embed=!0,ct.prototype.parse=function(t){for(let e=this.plugins.length;e--;)this.plugins[e].onUpdate&&(t=this.plugins[e].onUpdate(t,et)||t);for(new ht(this).parse(t);this.stack.length;)this.popNode();return this.nodes.length>50&&ot(this.nodes),this.nodes},ct.prototype.expose=function(){for(let t=this.stack.length;t--;){const e=this.stack[t];if(e.c||"a"===e.name||"video"===e.name||"audio"===e.name)return;e.c=1}},ct.prototype.hook=function(t){for(let e=this.plugins.length;e--;)if(this.plugins[e].onParse&&!1===this.plugins[e].onParse(t,this))return!1;return!0},ct.prototype.getUrl=function(t){const e=this.options.domain;return"/"===t[0]?"/"===t[1]?t=(e?e.split("://")[0]:"http")+":"+t:e&&(t=e+t):t.includes("data:")||t.includes("://")||e&&(t=e+"/"+t),t},ct.prototype.parseStyle=function(t){const e=t.attrs,s=(this.tagStyle[t.name]||"").split(";").concat((e.style||"").split(";")),n={};let i="";e.id&&!this.xml&&(this.options.useAnchor?this.expose():"img"!==t.name&&"a"!==t.name&&"video"!==t.name&&"audio"!==t.name&&(e.id=void 0)),e.width&&(n.width=parseFloat(e.width)+(e.width.includes("%")?"%":"px"),e.width=void 0),e.height&&(n.height=parseFloat(e.height)+(e.height.includes("%")?"%":"px"),e.height=void 0);for(let r=0,l=s.length;r<l;r++){const t=s[r].split(":");if(t.length<2)continue;const e=t.shift().trim().toLowerCase();let l=t.join(":").trim();if("-"===l[0]&&l.lastIndexOf("-")>0||l.includes("safe"))i+=`;${e}:${l}`;else if(!n[e]||l.includes("import")||!n[e].includes("import")){if(l.includes("url")){let t=l.indexOf("(")+1;if(t){for(;'"'===l[t]||"'"===l[t]||it[l[t]];)t++;l=l.substr(0,t)+this.getUrl(l.substr(t))}}else l.includes("rpx")&&(l=l.replace(/[0-9.]+\s*rpx/g,(t=>parseFloat(t)*nt/750+"px")));n[e]=l}}return t.attrs.style=i,n},ct.prototype.onTagName=function(t){this.tagName=this.xml?t:t.toLowerCase(),"svg"===this.tagName&&(this.xml=(this.xml||0)+1,et.ignoreTags.style=void 0)},ct.prototype.onAttrName=function(t){"data-"===(t=this.xml?t:t.toLowerCase()).substr(0,5)?"data-src"!==t||this.attrs.src?"img"===this.tagName||"a"===this.tagName?this.attrName=t:this.attrName=void 0:this.attrName="src":(this.attrName=t,this.attrs[t]="T")},ct.prototype.onAttrVal=function(t){const e=this.attrName||"";"style"===e||"href"===e?this.attrs[e]=at(t,!0):e.includes("src")?this.attrs[e]=this.getUrl(at(t,!0)):e&&(this.attrs[e]=t)},ct.prototype.onOpenTag=function(t){const e=Object.create(null);e.name=this.tagName,e.attrs=this.attrs,this.options.nodes.length&&(e.type="node"),this.attrs=Object.create(null);const s=e.attrs,n=this.stack[this.stack.length-1],i=n?n.children:this.nodes,r=this.xml?t:et.voidTags[e.name];if(st[e.name]&&(s.class=st[e.name]+(s.class?" "+s.class:"")),"embed"===e.name&&this.expose(),"video"!==e.name&&"audio"!==e.name||("video"!==e.name||s.id||(s.id="v"+rt++),s.controls||s.autoplay||(s.controls="T"),e.src=[],s.src&&(e.src.push(s.src),s.src=void 0),this.expose()),r){if(!this.hook(e)||et.ignoreTags[e.name])return void("base"!==e.name||this.options.domain?"source"===e.name&&n&&("video"===n.name||"audio"===n.name)&&s.src&&n.src.push(s.src):this.options.domain=s.href);const t=this.parseStyle(e);if("img"===e.name){if(s.src&&(s.src.includes("webp")&&(e.webp="T"),s.src.includes("data:")&&!s["original-src"]&&(s.ignore="T"),!s.ignore||e.webp||s.src.includes("cloud://"))){for(let i=this.stack.length;i--;){const n=this.stack[i];"a"===n.name&&(e.a=n.attrs),"table"!==n.name||e.webp||s.src.includes("cloud://")||(!t.display||t.display.includes("inline")?e.t="inline-block":e.t=t.display,t.display=void 0),n.c=1}s.i=this.imgList.length.toString();let n=s["original-src"]||s.src;this.imgList.push(n),e.t||(this.imgList._unloadimgs+=1),this.options.lazyLoad&&(s["data-src"]=s.src,s.src=void 0)}"inline"===t.display&&(t.display=""),s.ignore&&(t["max-width"]=t["max-width"]||"100%",s.style+=";-webkit-touch-callout:none"),parseInt(t.width)>nt&&(t.height=void 0),isNaN(parseInt(t.width))||(e.w="T"),!isNaN(parseInt(t.height))&&(!t.height.includes("%")||n&&(n.attrs.style||"").includes("height"))&&(e.h="T")}else if("svg"===e.name)return i.push(e),this.stack.push(e),void this.popNode();for(const e in t)t[e]&&(s.style+=`;${e}:${t[e].replace(" !important","")}`);s.style=s.style.substr(1)||void 0}else("pre"===e.name||(s.style||"").includes("white-space")&&s.style.includes("pre"))&&2!==this.pre&&(this.pre=e.pre=1),e.children=[],this.stack.push(e);i.push(e)},ct.prototype.onCloseTag=function(t){let e;for(t=this.xml?t:t.toLowerCase(),e=this.stack.length;e--&&this.stack[e].name!==t;);if(-1!==e)for(;this.stack.length>e;)this.popNode();else if("p"===t||"br"===t){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push({name:t,attrs:{class:st[t]||"",style:this.tagStyle[t]||""}})}},ct.prototype.popNode=function(){const t=this.stack.pop();let e=t.attrs;const s=t.children,n=this.stack[this.stack.length-1],i=n?n.children:this.nodes;if(!this.hook(t)||et.ignoreTags[t.name])return"title"===t.name&&s.length&&"text"===s[0].type&&this.options.setTitle&&R({title:s[0].text}),void i.pop();if(t.pre&&2!==this.pre){this.pre=t.pre=void 0;for(let t=this.stack.length;t--;)this.stack[t].pre&&(this.pre=1)}const r={};if("svg"===t.name){if(this.xml>1)return void this.xml--;let s="";const n=e.style;return e.style="",e.xmlns="http://www.w3.org/2000/svg",function t(e){if("text"===e.type)return void(s+=e.text);const n=et.svgDict[e.name]||e.name;s+="<"+n;for(const i in e.attrs){const t=e.attrs[i];t&&(s+=` ${et.svgDict[i]||i}="${t}"`)}if(e.children){s+=">";for(let s=0;s<e.children.length;s++)t(e.children[s]);s+="</"+n+">"}else s+="/>"}(t),t.name="img",t.attrs={src:"data:image/svg+xml;utf8,"+s.replace(/#/g,"%23"),style:n,ignore:"T"},t.children=void 0,this.xml=!1,void(et.ignoreTags.style=!0)}if(e.align&&("table"===t.name?"center"===e.align?r["margin-inline-start"]=r["margin-inline-end"]="auto":r.float=e.align:r["text-align"]=e.align,e.align=void 0),e.dir&&(r.direction=e.dir,e.dir=void 0),"font"===t.name&&(e.color&&(r.color=e.color,e.color=void 0),e.face&&(r["font-family"]=e.face,e.face=void 0),e.size)){let t=parseInt(e.size);isNaN(t)||(t<1?t=1:t>7&&(t=7),r["font-size"]=["x-small","small","medium","large","x-large","xx-large","xxx-large"][t-1]),e.size=void 0}if((e.class||"").includes("align-center")&&(r["text-align"]="center"),Object.assign(r,this.parseStyle(t)),"table"!==t.name&&parseInt(r.width)>nt&&(r["max-width"]="100%",r["box-sizing"]="border-box"),et.blockTags[t.name]?t.name="div":et.trustTags[t.name]||this.xml||(t.name="span"),"a"===t.name||"ad"===t.name||"iframe"===t.name)this.expose();else if("video"===t.name)(r.height||"").includes("auto")&&(r.height=void 0);else if("ul"!==t.name&&"ol"!==t.name||!t.c){if("table"===t.name){let n=parseFloat(e.cellpadding),i=parseFloat(e.cellspacing);const l=parseFloat(e.border),a=r["border-color"],o=r["border-style"];if(t.c&&(isNaN(n)&&(n=2),isNaN(i)&&(i=2)),l&&(e.style+=`;border:${l}px ${o||"solid"} ${a||"gray"}`),t.flag&&t.c){r.display="grid",i?(r["grid-gap"]=i+"px",r.padding=i+"px"):l&&(e.style+=";border-left:0;border-top:0");const c=[],h=[],u=[],p={};!function t(e){for(let s=0;s<e.length;s++)"tr"===e[s].name?h.push(e[s]):t(e[s].children||[])}(s);for(let t=1;t<=h.length;t++){let e=1;for(let s=0;s<h[t-1].children.length;s++){const r=h[t-1].children[s];if("td"===r.name||"th"===r.name){for(;p[t+"."+e];)e++;let s=r.attrs.style||"",h=s.indexOf("width")?s.indexOf(";width"):0;if(-1!==h){let t=s.indexOf(";",h+6);-1===t&&(t=s.length),r.attrs.colspan||(c[e]=s.substring(h?h+7:6,t)),s=s.substr(0,h)+s.substr(t)}if(s+=";display:flex",h=s.indexOf("vertical-align"),-1!==h){const t=s.substr(h+15,10);t.includes("middle")?s+=";align-items:center":t.includes("bottom")&&(s+=";align-items:flex-end")}else s+=";align-items:center";if(h=s.indexOf("text-align"),-1!==h){const t=s.substr(h+11,10);t.includes("center")?s+=";justify-content: center":t.includes("right")&&(s+=";justify-content: right")}if(s=(l?`;border:${l}px ${o||"solid"} ${a||"gray"}`+(i?"":";border-right:0;border-bottom:0"):"")+(n?`;padding:${n}px`:"")+";"+s,r.attrs.colspan&&(s+=`;grid-column-start:${e};grid-column-end:${e+parseInt(r.attrs.colspan)}`,r.attrs.rowspan||(s+=`;grid-row-start:${t};grid-row-end:${t+1}`),e+=parseInt(r.attrs.colspan)-1),r.attrs.rowspan){s+=`;grid-row-start:${t};grid-row-end:${t+parseInt(r.attrs.rowspan)}`,r.attrs.colspan||(s+=`;grid-column-start:${e};grid-column-end:${e+1}`);for(let s=1;s<r.attrs.rowspan;s++)for(let n=0;n<(r.attrs.colspan||1);n++)p[t+s+"."+(e-n)]=1}s&&(r.attrs.style=s),u.push(r),e++}}if(1===t){let t="";for(let s=1;s<e;s++)t+=(c[s]?c[s]:"auto")+" ";r["grid-template-columns"]=t}}t.children=u}else t.c&&(r.display="table"),isNaN(i)||(r["border-spacing"]=i+"px"),(l||n)&&function t(e){for(let s=0;s<e.length;s++){const i=e[s];"th"===i.name||"td"===i.name?(l&&(i.attrs.style=`border:${l}px ${o||"solid"} ${a||"gray"};${i.attrs.style||""}`),n&&(i.attrs.style=`padding:${n}px;${i.attrs.style||""}`)):i.children&&t(i.children)}}(s);if(this.options.scrollTable&&!(e.style||"").includes("inline")){const s=Object.assign({},t);t.name="div",t.attrs={style:"overflow:auto"},t.children=[s],e=s.attrs}}else if("td"!==t.name&&"th"!==t.name||!e.colspan&&!e.rowspan)if("ruby"===t.name){t.name="span";for(let t=0;t<s.length-1;t++)"text"===s[t].type&&"rt"===s[t+1].name&&(s[t]={name:"div",attrs:{style:"display:inline-block;text-align:center"},children:[{name:"div",attrs:{style:"font-size:50%;"+(s[t+1].attrs.style||"")},children:s[t+1].children},s[t]]},s.splice(t+1,1))}else t.c&&function(t){t.c=2;for(let e=t.children.length;e--;){const s=t.children[e];s.c&&"table"!==s.name||(t.c=1)}}(t);else for(let a=this.stack.length;a--;)if("table"===this.stack[a].name){this.stack[a].flag=1;break}}else{const t={a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"};t[e.type]&&(e.style+=";list-style-type:"+t[e.type],e.type=void 0);for(let e=s.length;e--;)"li"===s[e].name&&(s[e].c=1)}if((r.display||"").includes("flex")&&!t.c)for(let a=s.length;a--;){const t=s[a];t.f&&(t.attrs.style=(t.attrs.style||"")+t.f,t.f=void 0)}const l=n&&((n.attrs.style||"").includes("flex")||(n.attrs.style||"").includes("grid"))&&!t.c;l&&(t.f=";max-width:100%"),s.length>=50&&t.c&&!(r.display||"").includes("flex")&&ot(s);for(const a in r)if(r[a]){const s=`;${a}:${r[a].replace(" !important","")}`;l&&(a.includes("flex")&&"flex-direction"!==a||"align-self"===a||a.includes("grid")||"-"===r[a][0]||a.includes("width")&&s.includes("%"))?(t.f+=s,"width"===a&&(e.style+=";width:100%")):e.style+=s}e.style=e.style.substr(1)||void 0},ct.prototype.onText=function(t){if(!this.pre){let e,s="";for(let n=0,i=t.length;n<i;n++)it[t[n]]?(" "!==s[s.length-1]&&(s+=" "),"\n"!==t[n]||e||(e=!0)):s+=t[n];if(" "===s){if(e)return;{const t=this.stack[this.stack.length-1];if(t&&"t"===t.name[0])return}}t=s}const e=Object.create(null);if(e.type="text",e.text=at(t),this.hook(e)){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push(e)}},ht.prototype.parse=function(t){this.content=t||"",this.i=0,this.start=0,this.state=this.text;for(let e=this.content.length;-1!==this.i&&this.i<e;)this.state()},ht.prototype.checkClose=function(t){const e="/"===this.content[this.i];return!!(">"===this.content[this.i]||e&&">"===this.content[this.i+1])&&(t&&this.handler[t](this.content.substring(this.start,this.i)),this.i+=e?2:1,this.start=this.i,this.handler.onOpenTag(e),"script"===this.handler.tagName?(this.i=this.content.indexOf("</",this.i),-1!==this.i&&(this.i+=2,this.start=this.i),this.state=this.endTag):this.state=this.text,!0)},ht.prototype.text=function(){if(this.i=this.content.indexOf("<",this.i),-1===this.i)return void(this.start<this.content.length&&this.handler.onText(this.content.substring(this.start,this.content.length)));const t=this.content[this.i+1];if(t>="a"&&t<="z"||t>="A"&&t<="Z")this.start!==this.i&&this.handler.onText(this.content.substring(this.start,this.i)),this.start=++this.i,this.state=this.tagName;else if("/"===t||"!"===t||"?"===t){this.start!==this.i&&this.handler.onText(this.content.substring(this.start,this.i));const e=this.content[this.i+2];if("/"===t&&(e>="a"&&e<="z"||e>="A"&&e<="Z"))return this.i+=2,this.start=this.i,void(this.state=this.endTag);let s="--\x3e";"!"===t&&"-"===this.content[this.i+2]&&"-"===this.content[this.i+3]||(s=">"),this.i=this.content.indexOf(s,this.i),-1!==this.i&&(this.i+=s.length,this.start=this.i)}else this.i++},ht.prototype.tagName=function(){if(it[this.content[this.i]]){for(this.handler.onTagName(this.content.substring(this.start,this.i));it[this.content[++this.i]];);this.i<this.content.length&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)}else this.checkClose("onTagName")||this.i++},ht.prototype.attrName=function(){let t=this.content[this.i];if(it[t]||"="===t){this.handler.onAttrName(this.content.substring(this.start,this.i));let e="="===t;const s=this.content.length;for(;++this.i<s;)if(t=this.content[this.i],!it[t]){if(this.checkClose())return;if(e)return this.start=this.i,void(this.state=this.attrVal);if("="!==this.content[this.i])return this.start=this.i,void(this.state=this.attrName);e=!0}}else this.checkClose("onAttrName")||this.i++},ht.prototype.attrVal=function(){const t=this.content[this.i],e=this.content.length;if('"'===t||"'"===t){if(this.start=++this.i,this.i=this.content.indexOf(t,this.i),-1===this.i)return;this.handler.onAttrVal(this.content.substring(this.start,this.i))}else for(;this.i<e;this.i++){if(it[this.content[this.i]]){this.handler.onAttrVal(this.content.substring(this.start,this.i));break}if(this.checkClose("onAttrVal"))return}for(;it[this.content[++this.i]];);this.i<e&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)},ht.prototype.endTag=function(){const t=this.content[this.i];if(it[t]||">"===t||"/"===t){if(this.handler.onCloseTag(this.content.substring(this.start,this.i)),">"!==t&&(this.i=this.content.indexOf(">",this.i),-1===this.i))return;this.start=++this.i,this.state=this.text}else this.i++};const ut=[];const pt=Z({name:"uv-parse",data:()=>({nodes:[]}),props:{containerStyle:{type:String,default:""},content:{type:String,default:""},copyLink:{type:[Boolean,String],default:!0},domain:String,errorImg:{type:String,default:""},lazyLoad:{type:[Boolean,String],default:!1},loadingImg:{type:String,default:""},pauseVideo:{type:[Boolean,String],default:!0},previewImg:{type:[Boolean,String],default:!0},scrollTable:[Boolean,String],selectable:[Boolean,String],setTitle:{type:[Boolean,String],default:!0},showImgMenu:{type:[Boolean,String],default:!0},tagStyle:Object,useAnchor:[Boolean,Number]},emits:["load","ready","imgtap","linktap","play","error"],components:{node:tt},watch:{content(t){this.setContent(t)}},created(){this.plugins=[];for(let t=ut.length;t--;)this.plugins.push(new ut[t](this))},mounted(){this.content&&!this.nodes.length&&this.setContent(this.content)},beforeDestroy(){this._hook("onDetached")},methods:{in(t,e,s){t&&e&&s&&(this._in={page:t,selector:e,scrollTop:s})},navigateTo(t,e){return new Promise(((s,n)=>{if(!this.useAnchor)return void n(Error("Anchor is disabled"));e=e||parseInt(this.useAnchor)||0;const i=I().in(this._in?this._in.page:this).select((this._in?this._in.selector:"._root")+(t?` #${t}`:"")).boundingClientRect();this._in?i.select(this._in.selector).scrollOffset().select(this._in.selector).boundingClientRect():i.selectViewport().scrollOffset(),i.exec((t=>{if(!t[0])return void n(Error("Label not found"));const i=t[1].scrollTop+t[0].top-(t[2]?t[2].top:0)+e;this._in?this._in.page[this._in.scrollTop]=i:S({scrollTop:i,duration:300}),s()}))}))},getText(t){let e="";return function t(s){for(let n=0;n<s.length;n++){const i=s[n];if("text"===i.type)e+=i.text.replace(/&amp;/g,"&");else if("br"===i.name)e+="\n";else{const s="p"===i.name||"div"===i.name||"tr"===i.name||"li"===i.name||"h"===i.name[0]&&i.name[1]>"0"&&i.name[1]<"7";s&&e&&"\n"!==e[e.length-1]&&(e+="\n"),i.children&&t(i.children),s&&"\n"!==e[e.length-1]?e+="\n":"td"!==i.name&&"th"!==i.name||(e+="\t")}}}(t||this.nodes),e},getRect(){return new Promise(((t,e)=>{I().in(this).select("#_root").boundingClientRect().exec((s=>s[0]?t(s[0]):e(Error("Root label not found"))))}))},pauseMedia(){for(let t=(this._videos||[]).length;t--;)this._videos[t].pause()},setPlaybackRate(t){this.playbackRate=t;for(let e=(this._videos||[]).length;e--;)this._videos[e].playbackRate(t)},setContent(t,e){e&&this.imgList||(this.imgList=[]);const s=new ct(this).parse(t);if(this.$set(this,"nodes",e?(this.nodes||[]).concat(s):s),this._videos=[],this.$nextTick((()=>{this._hook("onLoad"),this.$emit("load")})),this.lazyLoad||this.imgList._unloadimgs<this.imgList.length/2){let t=0;const e=s=>{s&&s.height||(s={}),s.height===t?this.$emit("ready",s):(t=s.height,setTimeout((()=>{this.getRect().then(e).catch(e)}),350))};this.getRect().then(e).catch(e)}else this.imgList._unloadimgs||this.getRect().then((t=>{this.$emit("ready",t)})).catch((()=>{this.$emit("ready",{})}))},_hook(t){for(let e=ut.length;e--;)this.plugins[e][t]&&this.plugins[e][t]()}}},[["render",function(t,e,s,n,i,r){const l=a("node"),u=_;return o(),c(u,{id:"_root",class:m((s.selectable?"_select ":"")+"_root"),style:g(s.containerStyle)},{default:h((()=>[i.nodes[0]?(o(),c(l,{key:1,childs:i.nodes,opts:[s.lazyLoad,s.loadingImg,s.errorImg,s.showImgMenu,s.selectable],name:"span"},null,8,["childs","opts"])):A(t.$slots,"default",{key:0},void 0,!0)])),_:3},8,["class","style"])}],["__scopeId","data-v-027a94fb"]]);function dt(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let gt={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function ft(t){gt=t}const mt=/[&<>"']/,kt=new RegExp(mt.source,"g"),xt=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,bt=new RegExp(xt.source,"g"),yt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wt=t=>yt[t];function vt(t,e){if(e){if(mt.test(t))return t.replace(kt,wt)}else if(xt.test(t))return t.replace(bt,wt);return t}const _t=/(^|[^\[])\^/g;function $t(t,e){let s="string"==typeof t?t:t.source;e=e||"";const n={replace:(t,e)=>{let i="string"==typeof e?e:e.source;return i=i.replace(_t,"$1"),s=s.replace(t,i),n},getRegex:()=>new RegExp(s,e)};return n}function Tt(t){try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const zt={exec:()=>null};function Rt(t,e){const s=t.replace(/\|/g,((t,e,s)=>{let n=!1,i=e;for(;--i>=0&&"\\"===s[i];)n=!n;return n?"|":" |"})).split(/ \|/);let n=0;if(s[0].trim()||s.shift(),s.length>0&&!s[s.length-1].trim()&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;n<s.length;n++)s[n]=s[n].trim().replace(/\\\|/g,"|");return s}function It(t,e,s){const n=t.length;if(0===n)return"";let i=0;for(;i<n;){const r=t.charAt(n-i-1);if(r!==e||s){if(r===e||!s)break;i++}else i++}return t.slice(0,n-i)}function St(t,e,s,n){const i=e.href,r=e.title?vt(e.title):null,l=t[1].replace(/\\([\[\]])/g,"$1");if("!"!==t[0].charAt(0)){n.state.inLink=!0;const t={type:"link",raw:s,href:i,title:r,text:l,tokens:n.inlineTokens(l)};return n.state.inLink=!1,t}return{type:"image",raw:s,href:i,title:r,text:vt(l)}}class At{constructor(t){e(this,"options"),e(this,"rules"),e(this,"lexer"),this.options=t||gt}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const t=e[0].replace(/^(?: {1,4}| {0,3}\t)/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:It(t,"\n")}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const t=e[0],s=function(t,e){const s=t.match(/^(\s+)(?:```)/);if(null===s)return e;const n=s[1];return e.split("\n").map((t=>{const e=t.match(/^\s+/);if(null===e)return t;const[s]=e;return s.length>=n.length?t.slice(n.length):t})).join("\n")}(t,e[3]||"");return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let t=e[2].trim();if(/#$/.test(t)){const e=It(t,"#");this.options.pedantic?t=e.trim():e&&!/ $/.test(e)||(t=e.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:It(e[0],"\n")}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){let t=It(e[0],"\n").split("\n"),s="",n="";const i=[];for(;t.length>0;){let e=!1;const r=[];let l;for(l=0;l<t.length;l++)if(/^ {0,3}>/.test(t[l]))r.push(t[l]),e=!0;else{if(e)break;r.push(t[l])}t=t.slice(l);const a=r.join("\n"),o=a.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,"\n    $1").replace(/^ {0,3}>[ \t]?/gm,"");s=s?`${s}\n${a}`:a,n=n?`${n}\n${o}`:o;const c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(o,i,!0),this.lexer.state.top=c,0===t.length)break;const h=i[i.length-1];if("code"===(null==h?void 0:h.type))break;if("blockquote"===(null==h?void 0:h.type)){const e=h,r=e.raw+"\n"+t.join("\n"),l=this.blockquote(r);i[i.length-1]=l,s=s.substring(0,s.length-e.raw.length)+l.raw,n=n.substring(0,n.length-e.text.length)+l.text;break}if("list"!==(null==h?void 0:h.type));else{const e=h,r=e.raw+"\n"+t.join("\n"),l=this.list(r);i[i.length-1]=l,s=s.substring(0,s.length-h.raw.length)+l.raw,n=n.substring(0,n.length-e.raw.length)+l.raw,t=r.substring(i[i.length-1].raw.length).split("\n")}}return{type:"blockquote",raw:s,tokens:i,text:n}}}list(t){let e=this.rules.block.list.exec(t);if(e){let s=e[1].trim();const n=s.length>1,i={type:"list",raw:"",ordered:n,start:n?+s.slice(0,-1):"",loose:!1,items:[]};s=n?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=n?s:"[*+-]");const r=new RegExp(`^( {0,3}${s})((?:[\t ][^\\n]*)?(?:\\n|$))`);let l=!1;for(;t;){let s=!1,n="",a="";if(!(e=r.exec(t)))break;if(this.rules.block.hr.test(t))break;n=e[0],t=t.substring(n.length);let o=e[2].split("\n",1)[0].replace(/^\t+/,(t=>" ".repeat(3*t.length))),c=t.split("\n",1)[0],h=!o.trim(),u=0;if(this.options.pedantic?(u=2,a=o.trimStart()):h?u=e[1].length+1:(u=e[2].search(/[^ ]/),u=u>4?1:u,a=o.slice(u),u+=e[1].length),h&&/^[ \t]*$/.test(c)&&(n+=c+"\n",t=t.substring(c.length+1),s=!0),!s){const e=new RegExp(`^ {0,${Math.min(3,u-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),s=new RegExp(`^ {0,${Math.min(3,u-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),i=new RegExp(`^ {0,${Math.min(3,u-1)}}(?:\`\`\`|~~~)`),r=new RegExp(`^ {0,${Math.min(3,u-1)}}#`),l=new RegExp(`^ {0,${Math.min(3,u-1)}}<[a-z].*>`,"i");for(;t;){const p=t.split("\n",1)[0];let d;if(c=p,this.options.pedantic?(c=c.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  "),d=c):d=c.replace(/\t/g,"    "),i.test(c))break;if(r.test(c))break;if(l.test(c))break;if(e.test(c))break;if(s.test(c))break;if(d.search(/[^ ]/)>=u||!c.trim())a+="\n"+d.slice(u);else{if(h)break;if(o.replace(/\t/g,"    ").search(/[^ ]/)>=4)break;if(i.test(o))break;if(r.test(o))break;if(s.test(o))break;a+="\n"+c}h||c.trim()||(h=!0),n+=p+"\n",t=t.substring(p.length+1),o=d.slice(u)}}i.loose||(l?i.loose=!0:/\n[ \t]*\n[ \t]*$/.test(n)&&(l=!0));let p,d=null;this.options.gfm&&(d=/^\[[ xX]\] /.exec(a),d&&(p="[ ] "!==d[0],a=a.replace(/^\[[ xX]\] +/,""))),i.items.push({type:"list_item",raw:n,task:!!d,checked:p,loose:!1,text:a,tokens:[]}),i.raw+=n}i.items[i.items.length-1].raw=i.items[i.items.length-1].raw.trimEnd(),i.items[i.items.length-1].text=i.items[i.items.length-1].text.trimEnd(),i.raw=i.raw.trimEnd();for(let t=0;t<i.items.length;t++)if(this.lexer.state.top=!1,i.items[t].tokens=this.lexer.blockTokens(i.items[t].text,[]),!i.loose){const e=i.items[t].tokens.filter((t=>"space"===t.type)),s=e.length>0&&e.some((t=>/\n.*\n/.test(t.raw)));i.loose=s}if(i.loose)for(let t=0;t<i.items.length;t++)i.items[t].loose=!0;return i}}html(t){const e=this.rules.block.html.exec(t);if(e){return{type:"html",block:!0,raw:e[0],pre:"pre"===e[1]||"script"===e[1]||"style"===e[1],text:e[0]}}}def(t){const e=this.rules.block.def.exec(t);if(e){const t=e[1].toLowerCase().replace(/\s+/g," "),s=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",n=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:s,title:n}}}table(t){const e=this.rules.block.table.exec(t);if(!e)return;if(!/[:|]/.test(e[2]))return;const s=Rt(e[1]),n=e[2].replace(/^\||\| *$/g,"").split("|"),i=e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split("\n"):[],r={type:"table",raw:e[0],header:[],align:[],rows:[]};if(s.length===n.length){for(const t of n)/^ *-+: *$/.test(t)?r.align.push("right"):/^ *:-+: *$/.test(t)?r.align.push("center"):/^ *:-+ *$/.test(t)?r.align.push("left"):r.align.push(null);for(let t=0;t<s.length;t++)r.header.push({text:s[t],tokens:this.lexer.inline(s[t]),header:!0,align:r.align[t]});for(const t of i)r.rows.push(Rt(t,r.header.length).map(((t,e)=>({text:t,tokens:this.lexer.inline(t),header:!1,align:r.align[e]}))));return r}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:"="===e[2].charAt(0)?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const t="\n"===e[1].charAt(e[1].length-1)?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:vt(e[1])}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const t=e[2].trim();if(!this.options.pedantic&&/^</.test(t)){if(!/>$/.test(t))return;const e=It(t.slice(0,-1),"\\");if((t.length-e.length)%2==0)return}else{const t=function(t,e){if(-1===t.indexOf(e[1]))return-1;let s=0;for(let n=0;n<t.length;n++)if("\\"===t[n])n++;else if(t[n]===e[0])s++;else if(t[n]===e[1]&&(s--,s<0))return n;return-1}(e[2],"()");if(t>-1){const s=(0===e[0].indexOf("!")?5:4)+e[1].length+t;e[2]=e[2].substring(0,t),e[0]=e[0].substring(0,s).trim(),e[3]=""}}let s=e[2],n="";if(this.options.pedantic){const t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);t&&(s=t[1],n=t[3])}else n=e[3]?e[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(t)?s.slice(1):s.slice(1,-1)),St(e,{href:s?s.replace(this.rules.inline.anyPunctuation,"$1"):s,title:n?n.replace(this.rules.inline.anyPunctuation,"$1"):n},e[0],this.lexer)}}reflink(t,e){let s;if((s=this.rules.inline.reflink.exec(t))||(s=this.rules.inline.nolink.exec(t))){const t=e[(s[2]||s[1]).replace(/\s+/g," ").toLowerCase()];if(!t){const t=s[0].charAt(0);return{type:"text",raw:t,text:t}}return St(s,t,s[0],this.lexer)}}emStrong(t,e,s=""){let n=this.rules.inline.emStrongLDelim.exec(t);if(!n)return;if(n[3]&&s.match(/[\p{L}\p{N}]/u))return;if(!(n[1]||n[2]||"")||!s||this.rules.inline.punctuation.exec(s)){const s=[...n[0]].length-1;let i,r,l=s,a=0;const o="*"===n[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(o.lastIndex=0,e=e.slice(-1*t.length+s);null!=(n=o.exec(e));){if(i=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!i)continue;if(r=[...i].length,n[3]||n[4]){l+=r;continue}if((n[5]||n[6])&&s%3&&!((s+r)%3)){a+=r;continue}if(l-=r,l>0)continue;r=Math.min(r,r+l+a);const e=[...n[0]][0].length,o=t.slice(0,s+n.index+e+r);if(Math.min(s,r)%2){const t=o.slice(1,-1);return{type:"em",raw:o,text:t,tokens:this.lexer.inlineTokens(t)}}const c=o.slice(2,-2);return{type:"strong",raw:o,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let t=e[2].replace(/\n/g," ");const s=/[^ ]/.test(t),n=/^ /.test(t)&&/ $/.test(t);return s&&n&&(t=t.substring(1,t.length-1)),t=vt(t,!0),{type:"codespan",raw:e[0],text:t}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){const e=this.rules.inline.autolink.exec(t);if(e){let t,s;return"@"===e[2]?(t=vt(e[1]),s="mailto:"+t):(t=vt(e[1]),s=t),{type:"link",raw:e[0],text:t,href:s,tokens:[{type:"text",raw:t,text:t}]}}}url(t){var e;let s;if(s=this.rules.inline.url.exec(t)){let t,n;if("@"===s[2])t=vt(s[0]),n="mailto:"+t;else{let i;do{i=s[0],s[0]=(null==(e=this.rules.inline._backpedal.exec(s[0]))?void 0:e[0])??""}while(i!==s[0]);t=vt(s[0]),n="www."===s[1]?"http://"+s[0]:s[0]}return{type:"link",raw:s[0],text:t,href:n,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(t){const e=this.rules.inline.text.exec(t);if(e){let t;return t=this.lexer.state.inRawBlock?e[0]:vt(e[0]),{type:"text",raw:e[0],text:t}}}}const Lt=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Nt=/(?:[*+-]|\d{1,9}[.)])/,Ot=$t(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Nt).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Ct=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Et=/(?!\s*\])(?:\\.|[^\[\]\\])+/,jt=$t(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Et).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),qt=$t(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Nt).getRegex(),Pt="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Zt=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Bt=$t("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",Zt).replace("tag",Pt).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Dt=$t(Ct).replace("hr",Lt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pt).getRegex(),Qt={blockquote:$t(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Dt).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:jt,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:Lt,html:Bt,lheading:Ot,list:qt,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:Dt,table:zt,text:/^[^\n]+/},Mt=$t("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Lt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pt).getRegex(),Ft={...Qt,table:Mt,paragraph:$t(Ct).replace("hr",Lt).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Mt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Pt).getRegex()},Ut={...Qt,html:$t("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Zt).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:zt,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:$t(Ct).replace("hr",Lt).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Ot).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Vt=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Ht=/^( {2,}|\\)\n(?!\s*$)/,Xt=$t(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,"\\p{P}\\p{S}").getRegex(),Jt=$t(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,"\\p{P}\\p{S}").getRegex(),Gt=$t("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,"\\p{P}\\p{S}").getRegex(),Wt=$t("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,"\\p{P}\\p{S}").getRegex(),Kt=$t(/\\([punct])/,"gu").replace(/punct/g,"\\p{P}\\p{S}").getRegex(),Yt=$t(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),te=$t(Zt).replace("(?:--\x3e|$)","--\x3e").getRegex(),ee=$t("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",te).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),se=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ne=$t(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",se).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ie=$t(/^!?\[(label)\]\[(ref)\]/).replace("label",se).replace("ref",Et).getRegex(),re=$t(/^!?\[(ref)\](?:\[\])?/).replace("ref",Et).getRegex(),le={_backpedal:zt,anyPunctuation:Kt,autolink:Yt,blockSkip:/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,br:Ht,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:zt,emStrongLDelim:Jt,emStrongRDelimAst:Gt,emStrongRDelimUnd:Wt,escape:Vt,link:ne,nolink:re,punctuation:Xt,reflink:ie,reflinkSearch:$t("reflink|nolink(?!\\()","g").replace("reflink",ie).replace("nolink",re).getRegex(),tag:ee,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:zt},ae={...le,link:$t(/^!?\[(label)\]\((.*?)\)/).replace("label",se).getRegex(),reflink:$t(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",se).getRegex()},oe={...le,escape:$t(Vt).replace("])","~|])").getRegex(),url:$t(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},ce={...oe,br:$t(Ht).replace("{2,}","*").getRegex(),text:$t(oe.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},he={normal:Qt,gfm:Ft,pedantic:Ut},ue={normal:le,gfm:oe,breaks:ce,pedantic:ae};class pe{constructor(t){e(this,"tokens"),e(this,"options"),e(this,"state"),e(this,"tokenizer"),e(this,"inlineQueue"),this.tokens=[],this.tokens.links=Object.create(null),this.options=t||gt,this.options.tokenizer=this.options.tokenizer||new At,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const s={block:he.normal,inline:ue.normal};this.options.pedantic?(s.block=he.pedantic,s.inline=ue.pedantic):this.options.gfm&&(s.block=he.gfm,this.options.breaks?s.inline=ue.breaks:s.inline=ue.gfm),this.tokenizer.rules=s}static get rules(){return{block:he,inline:ue}}static lex(t,e){return new pe(e).lex(t)}static lexInline(t,e){return new pe(e).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,"\n"),this.blockTokens(t,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){const t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,e=[],s=!1){let n,i,r;for(this.options.pedantic&&(t=t.replace(/\t/g,"    ").replace(/^ +$/gm,""));t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((s=>!!(n=s.call({lexer:this},t,e))&&(t=t.substring(n.raw.length),e.push(n),!0)))))if(n=this.tokenizer.space(t))t=t.substring(n.raw.length),1===n.raw.length&&e.length>0?e[e.length-1].raw+="\n":e.push(n);else if(n=this.tokenizer.code(t))t=t.substring(n.raw.length),i=e[e.length-1],!i||"paragraph"!==i.type&&"text"!==i.type?e.push(n):(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=i.text);else if(n=this.tokenizer.fences(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.heading(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.hr(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.blockquote(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.list(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.html(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.def(t))t=t.substring(n.raw.length),i=e[e.length-1],!i||"paragraph"!==i.type&&"text"!==i.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(i.raw+="\n"+n.raw,i.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=i.text);else if(n=this.tokenizer.table(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.lheading(t))t=t.substring(n.raw.length),e.push(n);else{if(r=t,this.options.extensions&&this.options.extensions.startBlock){let e=1/0;const s=t.slice(1);let n;this.options.extensions.startBlock.forEach((t=>{n=t.call({lexer:this},s),"number"==typeof n&&n>=0&&(e=Math.min(e,n))})),e<1/0&&e>=0&&(r=t.substring(0,e+1))}if(this.state.top&&(n=this.tokenizer.paragraph(r)))i=e[e.length-1],s&&"paragraph"===(null==i?void 0:i.type)?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(n),s=r.length!==t.length,t=t.substring(n.raw.length);else if(n=this.tokenizer.text(t))t=t.substring(n.raw.length),i=e[e.length-1],i&&"text"===i.type?(i.raw+="\n"+n.raw,i.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=i.text):e.push(n);else if(t){const e="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(e);break}throw new Error(e)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){let s,n,i,r,l,a,o=t;if(this.tokens.links){const t=Object.keys(this.tokens.links);if(t.length>0)for(;null!=(r=this.tokenizer.rules.inline.reflinkSearch.exec(o));)t.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(r=this.tokenizer.rules.inline.blockSkip.exec(o));)o=o.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(r=this.tokenizer.rules.inline.anyPunctuation.exec(o));)o=o.slice(0,r.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;t;)if(l||(a=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((n=>!!(s=n.call({lexer:this},t,e))&&(t=t.substring(s.raw.length),e.push(s),!0)))))if(s=this.tokenizer.escape(t))t=t.substring(s.raw.length),e.push(s);else if(s=this.tokenizer.tag(t))t=t.substring(s.raw.length),n=e[e.length-1],n&&"text"===s.type&&"text"===n.type?(n.raw+=s.raw,n.text+=s.text):e.push(s);else if(s=this.tokenizer.link(t))t=t.substring(s.raw.length),e.push(s);else if(s=this.tokenizer.reflink(t,this.tokens.links))t=t.substring(s.raw.length),n=e[e.length-1],n&&"text"===s.type&&"text"===n.type?(n.raw+=s.raw,n.text+=s.text):e.push(s);else if(s=this.tokenizer.emStrong(t,o,a))t=t.substring(s.raw.length),e.push(s);else if(s=this.tokenizer.codespan(t))t=t.substring(s.raw.length),e.push(s);else if(s=this.tokenizer.br(t))t=t.substring(s.raw.length),e.push(s);else if(s=this.tokenizer.del(t))t=t.substring(s.raw.length),e.push(s);else if(s=this.tokenizer.autolink(t))t=t.substring(s.raw.length),e.push(s);else if(this.state.inLink||!(s=this.tokenizer.url(t))){if(i=t,this.options.extensions&&this.options.extensions.startInline){let e=1/0;const s=t.slice(1);let n;this.options.extensions.startInline.forEach((t=>{n=t.call({lexer:this},s),"number"==typeof n&&n>=0&&(e=Math.min(e,n))})),e<1/0&&e>=0&&(i=t.substring(0,e+1))}if(s=this.tokenizer.inlineText(i))t=t.substring(s.raw.length),"_"!==s.raw.slice(-1)&&(a=s.raw.slice(-1)),l=!0,n=e[e.length-1],n&&"text"===n.type?(n.raw+=s.raw,n.text+=s.text):e.push(s);else if(t){const e="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(e);break}throw new Error(e)}}else t=t.substring(s.raw.length),e.push(s);return e}}class de{constructor(t){e(this,"options"),e(this,"parser"),this.options=t||gt}space(t){return""}code({text:t,lang:e,escaped:s}){var n;const i=null==(n=(e||"").match(/^\S*/))?void 0:n[0],r=t.replace(/\n$/,"")+"\n";return i?'<pre><code class="language-'+vt(i)+'">'+(s?r:vt(r,!0))+"</code></pre>\n":"<pre><code>"+(s?r:vt(r,!0))+"</code></pre>\n"}blockquote({tokens:t}){return`<blockquote>\n${this.parser.parse(t)}</blockquote>\n`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>\n`}hr(t){return"<hr>\n"}list(t){const e=t.ordered,s=t.start;let n="";for(let r=0;r<t.items.length;r++){const e=t.items[r];n+=this.listitem(e)}const i=e?"ol":"ul";return"<"+i+(e&&1!==s?' start="'+s+'"':"")+">\n"+n+"</"+i+">\n"}listitem(t){let e="";if(t.task){const s=this.checkbox({checked:!!t.checked});t.loose?t.tokens.length>0&&"paragraph"===t.tokens[0].type?(t.tokens[0].text=s+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&"text"===t.tokens[0].tokens[0].type&&(t.tokens[0].tokens[0].text=s+" "+t.tokens[0].tokens[0].text)):t.tokens.unshift({type:"text",raw:s+" ",text:s+" "}):e+=s+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>\n`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>\n`}table(t){let e="",s="";for(let i=0;i<t.header.length;i++)s+=this.tablecell(t.header[i]);e+=this.tablerow({text:s});let n="";for(let i=0;i<t.rows.length;i++){const e=t.rows[i];s="";for(let t=0;t<e.length;t++)s+=this.tablecell(e[t]);n+=this.tablerow({text:s})}return n&&(n=`<tbody>${n}</tbody>`),"<table>\n<thead>\n"+e+"</thead>\n"+n+"</table>\n"}tablerow({text:t}){return`<tr>\n${t}</tr>\n`}tablecell(t){const e=this.parser.parseInline(t.tokens),s=t.header?"th":"td";return(t.align?`<${s} align="${t.align}">`:`<${s}>`)+e+`</${s}>\n`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${t}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:s}){const n=this.parser.parseInline(s),i=Tt(t);if(null===i)return n;let r='<a href="'+(t=i)+'"';return e&&(r+=' title="'+e+'"'),r+=">"+n+"</a>",r}image({href:t,title:e,text:s}){const n=Tt(t);if(null===n)return s;let i=`<img src="${t=n}" alt="${s}"`;return e&&(i+=` title="${e}"`),i+=">",i}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):t.text}}class ge{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}}class fe{constructor(t){e(this,"options"),e(this,"renderer"),e(this,"textRenderer"),this.options=t||gt,this.options.renderer=this.options.renderer||new de,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ge}static parse(t,e){return new fe(e).parse(t)}static parseInline(t,e){return new fe(e).parseInline(t)}parse(t,e=!0){let s="";for(let n=0;n<t.length;n++){const i=t[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){const t=i,e=this.options.extensions.renderers[t.type].call({parser:this},t);if(!1!==e||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(t.type)){s+=e||"";continue}}const r=i;switch(r.type){case"space":s+=this.renderer.space(r);continue;case"hr":s+=this.renderer.hr(r);continue;case"heading":s+=this.renderer.heading(r);continue;case"code":s+=this.renderer.code(r);continue;case"table":s+=this.renderer.table(r);continue;case"blockquote":s+=this.renderer.blockquote(r);continue;case"list":s+=this.renderer.list(r);continue;case"html":s+=this.renderer.html(r);continue;case"paragraph":s+=this.renderer.paragraph(r);continue;case"text":{let i=r,l=this.renderer.text(i);for(;n+1<t.length&&"text"===t[n+1].type;)i=t[++n],l+="\n"+this.renderer.text(i);s+=e?this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]}):l;continue}default:{const t='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(t),"";throw new Error(t)}}}return s}parseInline(t,e){e=e||this.renderer;let s="";for(let n=0;n<t.length;n++){const i=t[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[i.type]){const t=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==t||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(i.type)){s+=t||"";continue}}const r=i;switch(r.type){case"escape":case"text":s+=e.text(r);break;case"html":s+=e.html(r);break;case"link":s+=e.link(r);break;case"image":s+=e.image(r);break;case"strong":s+=e.strong(r);break;case"em":s+=e.em(r);break;case"codespan":s+=e.codespan(r);break;case"br":s+=e.br(r);break;case"del":s+=e.del(r);break;default:{const t='Token with "'+r.type+'" type was not found.';if(this.options.silent)return console.error(t),"";throw new Error(t)}}}return s}}class me{constructor(t){e(this,"options"),e(this,"block"),this.options=t||gt}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?pe.lex:pe.lexInline}provideParser(){return this.block?fe.parse:fe.parseInline}}e(me,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));const ke=new class{constructor(...t){e(this,"defaults",{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}),e(this,"options",this.setOptions),e(this,"parse",this.parseMarkdown(!0)),e(this,"parseInline",this.parseMarkdown(!1)),e(this,"Parser",fe),e(this,"Renderer",de),e(this,"TextRenderer",ge),e(this,"Lexer",pe),e(this,"Tokenizer",At),e(this,"Hooks",me),this.use(...t)}walkTokens(t,e){var s,n;let i=[];for(const r of t)switch(i=i.concat(e.call(this,r)),r.type){case"table":{const t=r;for(const s of t.header)i=i.concat(this.walkTokens(s.tokens,e));for(const s of t.rows)for(const t of s)i=i.concat(this.walkTokens(t.tokens,e));break}case"list":{const t=r;i=i.concat(this.walkTokens(t.items,e));break}default:{const t=r;(null==(n=null==(s=this.defaults.extensions)?void 0:s.childTokens)?void 0:n[t.type])?this.defaults.extensions.childTokens[t.type].forEach((s=>{const n=t[s].flat(1/0);i=i.concat(this.walkTokens(n,e))})):t.tokens&&(i=i.concat(this.walkTokens(t.tokens,e)))}}return i}use(...t){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach((t=>{const s={...t};if(s.async=this.defaults.async||s.async||!1,t.extensions&&(t.extensions.forEach((t=>{if(!t.name)throw new Error("extension name required");if("renderer"in t){const s=e.renderers[t.name];e.renderers[t.name]=s?function(...e){let n=t.renderer.apply(this,e);return!1===n&&(n=s.apply(this,e)),n}:t.renderer}if("tokenizer"in t){if(!t.level||"block"!==t.level&&"inline"!==t.level)throw new Error("extension level must be 'block' or 'inline'");const s=e[t.level];s?s.unshift(t.tokenizer):e[t.level]=[t.tokenizer],t.start&&("block"===t.level?e.startBlock?e.startBlock.push(t.start):e.startBlock=[t.start]:"inline"===t.level&&(e.startInline?e.startInline.push(t.start):e.startInline=[t.start]))}"childTokens"in t&&t.childTokens&&(e.childTokens[t.name]=t.childTokens)})),s.extensions=e),t.renderer){const e=this.defaults.renderer||new de(this.defaults);for(const s in t.renderer){if(!(s in e))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const n=s,i=t.renderer[n],r=e[n];e[n]=(...t)=>{let s=i.apply(e,t);return!1===s&&(s=r.apply(e,t)),s||""}}s.renderer=e}if(t.tokenizer){const e=this.defaults.tokenizer||new At(this.defaults);for(const s in t.tokenizer){if(!(s in e))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const n=s,i=t.tokenizer[n],r=e[n];e[n]=(...t)=>{let s=i.apply(e,t);return!1===s&&(s=r.apply(e,t)),s}}s.tokenizer=e}if(t.hooks){const e=this.defaults.hooks||new me;for(const s in t.hooks){if(!(s in e))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const n=s,i=t.hooks[n],r=e[n];me.passThroughHooks.has(s)?e[n]=t=>{if(this.defaults.async)return Promise.resolve(i.call(e,t)).then((t=>r.call(e,t)));const s=i.call(e,t);return r.call(e,s)}:e[n]=(...t)=>{let s=i.apply(e,t);return!1===s&&(s=r.apply(e,t)),s}}s.hooks=e}if(t.walkTokens){const e=this.defaults.walkTokens,n=t.walkTokens;s.walkTokens=function(t){let s=[];return s.push(n.call(this,t)),e&&(s=s.concat(e.call(this,t))),s}}this.defaults={...this.defaults,...s}})),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return pe.lex(t,e??this.defaults)}parser(t,e){return fe.parse(t,e??this.defaults)}parseMarkdown(t){return(e,s)=>{const n={...s},i={...this.defaults,...n},r=this.onError(!!i.silent,!!i.async);if(!0===this.defaults.async&&!1===n.async)return r(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(null==e)return r(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof e)return r(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=t);const l=i.hooks?i.hooks.provideLexer():t?pe.lex:pe.lexInline,a=i.hooks?i.hooks.provideParser():t?fe.parse:fe.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(e):e).then((t=>l(t,i))).then((t=>i.hooks?i.hooks.processAllTokens(t):t)).then((t=>i.walkTokens?Promise.all(this.walkTokens(t,i.walkTokens)).then((()=>t)):t)).then((t=>a(t,i))).then((t=>i.hooks?i.hooks.postprocess(t):t)).catch(r);try{i.hooks&&(e=i.hooks.preprocess(e));let t=l(e,i);i.hooks&&(t=i.hooks.processAllTokens(t)),i.walkTokens&&this.walkTokens(t,i.walkTokens);let s=a(t,i);return i.hooks&&(s=i.hooks.postprocess(s)),s}catch(o){return r(o)}}}onError(t,e){return s=>{if(s.message+="\nPlease report this to https://github.com/markedjs/marked.",t){const t="<p>An error occurred:</p><pre>"+vt(s.message+"",!0)+"</pre>";return e?Promise.resolve(t):t}if(e)return Promise.reject(s);throw s}}};function xe(t,e){return ke.parse(t,e)}xe.options=xe.setOptions=function(t){return ke.setOptions(t),xe.defaults=ke.defaults,ft(xe.defaults),xe},xe.getDefaults=dt,xe.defaults=gt,xe.use=function(...t){return ke.use(...t),xe.defaults=ke.defaults,ft(xe.defaults),xe},xe.walkTokens=function(t,e){return ke.walkTokens(t,e)},xe.parseInline=ke.parseInline,xe.Parser=fe,xe.parser=fe.parse,xe.Renderer=de,xe.TextRenderer=ge,xe.Lexer=pe,xe.lexer=pe.lex,xe.Tokenizer=At,xe.Hooks=me,xe.parse=xe,xe.options,xe.setOptions,xe.use,xe.walkTokens,xe.parseInline,fe.parse,pe.lex;const be=Z({__name:"articleDetail",setup(t){const e=L(),{checkLogin:s}=J(),n=N(),i=N(!1),l=N({}),a=N();async function g(){return await F({articleId:n.value._id})}async function m(){await s(),i.value=!i.value}function k(){i.value=!i.value}async function $(t){await V({userId:e.state.userInfo._id,articleId:n.value._id,content:t,...a.value}),j({title:"发布成功"}),k(),a.value={},l.value=await g()}D((async t=>{const e=JSON.parse(JSON.stringify(t.options));let s=await function(t){return B({name:"get_article_Detatil",data:t})}({articleId:e._id});n.value=s,n.value.browse_count++,l.value=await g()}));const T=O((()=>{var t,e;return(null==(t=null==n?void 0:n.value)?void 0:t.content)?xe(null==(e=null==n?void 0:n.value)?void 0:e.content):null}));function z(t){k(),a.value={comment_id:t.comment.comment_id,isRepaly:t.isRepaly},t.comment.repaly_id&&(a.value.repaly_id=t.comment.repaly_id)}const R=O((()=>{var t;return e.state.userInfo.author_likes_ids.includes(null==(t=n.value)?void 0:t.author.id)}));async function I(){var t,i,r;await s();const l=await(a={authorId:null==(t=n.value)?void 0:t.author.id,userId:e.state.userInfo._id},B({name:"updateFollow",data:a}));var a;j({title:l.msg});let o=[...e.state.userInfo.author_likes_ids];o.includes(null==(i=n.value)?void 0:i.author.id)?o=o.filter((t=>{var e;return t!=(null==(e=n.value)?void 0:e.author.id)})):o.push(null==(r=n.value)?void 0:r.author.id),q("updatefellow"),e.commit("updateUserInfo",{...e.state.userInfo,author_likes_ids:o})}const S=O((()=>{var t;return e.state.userInfo.thumbs_up_article_ids.includes(null==(t=n.value)?void 0:t._id)}));async function A(){var t;await s(),await(t={articId:n.value._id,userId:e.state.userInfo._id},B({name:"updateGoodOk",data:t}));let i=[...e.state.userInfo.thumbs_up_article_ids];i.includes(n.value._id)?(i=i.filter((t=>t!==n.value._id)),n.value.thumbs_up_count--):(i.push(n.value._id),n.value.thumbs_up_count++),e.commit("updateUserInfo",{...e.state.userInfo,thumbs_up_article_ids:i})}function Z(){r({url:`/pages/commentList/commentList?id=${n.value._id}`})}return(t,e)=>{const s=_,r=w,a=v,g=P,L=Q(C("uv-parse"),pt),N=Q(C("uni-icons"),M),O=Q(C("CommentMasker"),U);return o(),c(s,{class:"article-detail-container"},{default:h((()=>[y(s,{class:"detail-title"},{default:h((()=>{var t;return[x(b(null==(t=n.value)?void 0:t.title),1)]})),_:1}),y(s,{class:"detail-header"},{default:h((()=>[y(s,{class:"detail-logo"},{default:h((()=>{var t;return[y(r,{src:null==(t=n.value)?void 0:t.author.avatar,mode:"aspectFill"},null,8,["src"])]})),_:1}),y(s,{class:"detail-header-content"},{default:h((()=>[y(s,{class:"detail-header-content-title"},{default:h((()=>{var t;return[x(b(null==(t=n.value)?void 0:t.author.author_name),1)]})),_:1}),y(s,{class:"detail-header-content-info"},{default:h((()=>[y(a,null,{default:h((()=>{var t;return[x("发布时间："+b(null==(t=n.value)?void 0:t.create_time),1)]})),_:1}),E("br"),y(a,null,{default:h((()=>{var t;return[x("浏览量："+b(null==(t=n.value)?void 0:t.browse_count),1)]})),_:1}),y(a,null,{default:h((()=>{var t;return[x("赞："+b(null==(t=n.value)?void 0:t.thumbs_up_count),1)]})),_:1})])),_:1})])),_:1}),y(g,{type:"default",class:"detail-header-button",onClick:I},{default:h((()=>[x(b(R.value?"取消关注":"关注"),1)])),_:1})])),_:1}),y(s,{class:"detail-content-container"},{default:h((()=>[y(s,{class:"detail-html"},{default:h((()=>[y(L,{content:T.value,selectable:!0,lazyLoad:"true"},null,8,["content"])])),_:1}),y(s,{class:"detail-comment"},{default:h((()=>[x(" 最新评论 ")])),_:1}),(o(!0),u(p,null,d(l.value,(t=>(o(),c(s,{class:"comment-content-cointainer",key:t._id},{default:h((()=>[y(H,{commentData:t,onRepalyComment:z},null,8,["commentData"])])),_:2},1024)))),128)),l.value.length>0?(o(),c(s,{key:0,class:"no-data"},{default:h((()=>[x(" 暂无评论 ")])),_:1})):f("",!0)])),_:1}),y(s,{class:"detail-bottom"},{default:h((()=>[y(s,{class:"input-container",onClick:m},{default:h((()=>[y(a,null,{default:h((()=>[x("谈谈你的看法....")])),_:1}),y(N,{type:"compose",size:"16",color:"#f07373"})])),_:1}),y(s,{class:"detail-bottom-icons"},{default:h((()=>{var t;return[y(s,{class:"detail-bottom-icon-box",onClick:Z},{default:h((()=>[y(N,{type:"chat",size:"22",color:"#f07373"})])),_:1}),y(X,{itemId:null==(t=n.value)?void 0:t._id},null,8,["itemId"]),y(s,{class:"detail-bottom-icon-box",onClick:A},{default:h((()=>[y(N,{type:S.value?"hand-up-filled":"hand-up",size:"22",color:"#f07373"},null,8,["type"])])),_:1})]})),_:1})])),_:1}),y(O,{isshow:i.value,onCloseShow:k,onSendDataComent:$},null,8,["isshow"])])),_:1})}}},[["__scopeId","data-v-718f23e3"]]);export{be as default};
