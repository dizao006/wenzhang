import{N as a}from"./NavBar.W16ljO67.js";import{_ as e,r as t,w as i,a as s,b as n,o as l,c,d as o,e as r,u as d,f as u,F as v,g as m,n as x,h as I,t as p,i as g,j as f,S as L,k as _,l as b,m as h,p as w,q as j,s as y}from"./index-VArvefSN.js";import{_ as k}from"./uni-icons.BPusHlUG.js";import{u as C}from"./isLogin.i1xWMhdH.js";import{L as B}from"./ListItem.v_jmnuVf.js";import{g as A,a as N}from"./home.Bf2Mbiut.js";import"./listCard.CwASfMd0.js";import"./love.DBCKzdbg.js";import"./http.BhNkKofT.js";import"./uni-load-more.Bc3nc4_m.js";const S=e({__name:"TabBar",props:["activeIndex","labeList"],emits:["changeIndex"],setup(a,{emit:e}){let _=a,b=e,h=t("item0");const{checkLogin:w}=C();async function j(){await w(),g({url:"/pages/abelAdmin/abelAdmin"})}return i((()=>_.activeIndex),(a=>{h.value=`item${a}`})),(e,t)=>{const i=f,g=L,_=s(n("uni-icons"),k);return l(),c(i,{class:"tabBar"},{default:o((()=>[r(g,{"scroll-x":"true",class:"tabScroll","show-scrollbar":!1,"scroll-with-animation":!0,"scroll-into-view":d(h)},{default:o((()=>[r(i,{class:"box"},{default:o((()=>[(l(!0),u(v,null,m(a.labeList,((e,t)=>(l(),c(i,{onClick:a=>function(a){b("changeIndex",a)}(t),class:x([{active:a.activeIndex==t},"tab-item"]),key:e._id,id:`item${t}`},{default:o((()=>[I(p(e.name),1)])),_:2},1032,["onClick","class","id"])))),128))])),_:1})])),_:1},8,["scroll-into-view"]),r(i,{class:"icons"},{default:o((()=>[r(_,{type:"gear",size:"26",color:"#666",onClick:j})])),_:1})])),_:1})}}},[["__scopeId","data-v-772c18be"]]),z=e({__name:"ArticleList",props:["artList","activeIndex"],emits:["changeIndex"],setup(a,{emit:e}){let x=a,I=e,p=t({}),g=t({}),f=t();t(1);let L=t(6);function w(a){const e=a.detail.current;I("changeIndex",e)}async function j(a){g.value[x.activeIndex]||(g.value[x.activeIndex]={page:1,loading:"loading,",total:0});let{articleList:e,total:t}=await A({classify:a.name,page:g.value[x.activeIndex].page,pageSize:L.value}),i=p.value[x.activeIndex]||[];JSON.stringify(e)!==JSON.stringify(i)&&i.push(...e),p.value[x.activeIndex]=i,g.value[x.activeIndex].total=t}function y(){if(g.value[x.activeIndex].total===p.value[x.activeIndex].length)return g.value[x.activeIndex]={...g.value[x.activeIndex],loading:"noMore"},void _();g.value[x.activeIndex].page++,j(f.value)}return i([()=>x.artList,()=>x.activeIndex],(a=>{f.value=a[0][a[1]],j(f.value)}),{immediate:!0}),(a,e)=>{const t=s(n("ListItem"),B),i=b,I=h;return l(),c(I,{class:"swiper-container",current:d(x).activeIndex,onChange:w},{default:o((()=>[(l(!0),u(v,null,m(d(x).artList,(a=>(l(),c(i,{class:"swiper-item",key:a._id},{default:o((()=>[r(t,{loadData:d(g)[d(x).activeIndex],onLoadMore:y,articleList:d(p)[d(x).activeIndex],isLoadMore:!1},null,8,["loadData","articleList"])])),_:2},1024)))),128))])),_:1},8,["current"])}}},[["__scopeId","data-v-36cd0cdc"]]),D=e({__name:"index",setup(e){let u=t(0);const v=w(),m=t();function x(a){u.value=a}const I=t(),{checkLogin:p}=C();return j((async()=>{await p()})),y((async()=>{I.value=await N(),I.value=[{name:"全部"},...I.value],v.commit("setlabelList",I.value)})),i((()=>v.state.labelListItem),((a,e)=>{m.value=[{name:"全部"},...a]}),{immediate:!0,deep:!0}),(e,t)=>{const i=s(n("NavBar"),a),v=s(n("TabBar"),S),p=s(n("ArticleList"),z),g=f;return l(),c(g,{class:"container"},{default:o((()=>[r(i),r(v,{labeList:m.value.length>1?m.value:I.value,activeIndex:d(u),onChangeIndex:x},null,8,["labeList","activeIndex"]),r(p,{artList:m.value.length>1?m.value:I.value,activeIndex:d(u),class:"list-container",onChangeIndex:x},null,8,["artList","activeIndex"])])),_:1})}}},[["__scopeId","data-v-0b00c12e"]]);export{D as default};
